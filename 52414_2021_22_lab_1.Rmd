---
title: "52414 - lab 1 Solutions"
author: "Halit Cohen and Yoray Mauda"
date: "25/4/2022"
output: html_document
---


```{r, include=FALSE}
library(tidyverse) # This includes dplyr, stringr, ggplot2, ..
library(dplyr)
library(data.table)
library(rworldmap) # world map
library(ggthemes)
library(reshape2) # melt: change data-frame format long/wide
library(e1071) # skewness and kurtosis
```  

**Solution:**  

1. In this section, we will load the data frame, and will compute basic processing. Plus, we will list a table the top five dates as requested. 
```{r} 

# a. Loading the data:
df <- read.csv("https://raw.githubusercontent.com/DataScienceHU/r52414_2021_22_lab1-Mauda_Yoray_and_Cohen_Halit/main/owid-covid-data.csv")

# Modifying date because its in "character" class.
df$date <- as.Date(df$date,origin = "%Y-%m-%d")
class(df$date)
# b. Listing five top dates
High_income_new_cases <- filter(df,location == "High income")%>%
arrange(desc(new_cases))
top_n(High_income_new_cases[c("date","new_cases")],5)

High_income_new_deaths <- filter(df,location == "High income")%>%
  arrange(desc(new_deaths))
top_n(High_income_new_cases[c("date","new_deaths")],5)

High_income_new_vaccinations <- filter(df,location == "High income")%>%
  arrange(desc(new_vaccinations))
top_n(High_income_new_cases[c("date","new_vaccinations")],5)

```
[Solution text - description of analysis and results]


2. In this Question, we will compute a function that plots high and low income in one graph, as a function of date. 
```{r}
# a. Here we create the function
#להתייחס עריכם חסרין ולכתוב הסבר
function_question2 <- function(data_frame, col_name)
{
  filtered_covid_data_high <- data_frame %>% filter(location == "High income")
  filtered_covid_data_low <- data_frame %>% filter(location == "Low income")
  ggplot(filtered_covid_data_high, aes(date, {{col_name}})) + geom_point() +
    geom_point(data = filtered_covid_data_low, colour = "red")
}
# b. In this sub-question, we create four more plots based on demand
plot_1 <- function_question2(df,new_cases_per_million)
plot_1
plot_2 <- function_question2(df,new_cases_smoothed_per_million)
plot_2
plot_3 <- function_question2(df,new_deaths_smoothed)
plot_3
plot_4 <- function_question2(df,new_vaccinations_smoothed)
plot_4

```
[Solution text - description of analysis and results]

3. [Solution text - explanations] 
```{r} 
current <-df[c("location","continent","total_cases_per_million","total_vaccinations_per_hundred","people_fully_vaccinated_per_hundred","total_boosters_per_hundred","excess_mortality_cumulative_per_million","date")] %>%group_by(location)%>%slice(which.max(date))

```
[Solution text - description of analysis and results]

4. [Solution text - explanations] 
```{r} 
# Solution code in R 

```
[Solution text - description of analysis and results]

5. [Solution text - explanations] 
```{r} 
# Solution code in R 

```
[Solution text - description of analysis and results]

6. [Solution text - explanations] 
```{r} 
# Solution code in R 

```
[Solution text - description of analysis and results]

7. [Solution text - explanations] 
```{r} 
# Solution code in R 

```
[Solution text - description of analysis and results]

8. [Solution text - explanations] 
```{r} 
# Solution code in R 

```
[Solution text - description of analysis and results]

9. [Solution text - explanations] 
```{r} 
# Solution code in R 

```
[Solution text - description of analysis and results]

10. [Solution text - explanations] 
```{r} 
# Solution code in R 

```
[Solution text - description of analysis and results]

11. [Solution text - explanations] 
```{r} 
# Solution code in R 

```
[Solution text - description of analysis and results]

<br/><br/>  



